stages:
  - deploy

deploy:
  image: willhallonline/ansible:2.13-alpine-3.16
  stage: deploy
  script:
    - ansible-galaxy install -r requirements.yml --roles-path ansible/roles
    - cd ansible && ansible-galaxy collection build && cd ..
    - mv ansible/search_index-setup-*.tar.gz search_index-setup.tar.gz

  artifacts:
    name: ansible-collection
    paths:
      - search_index-setup.tar.gz
